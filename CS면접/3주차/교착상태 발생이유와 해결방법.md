교착 상태의 원인
- 상호배재: 한 프로세스가 자원을 독점하고 있으며 다른 프로세스들은 접근이 불가함
- 점유 대기: 특정 프로세스가 점유한 자원을 다른 프로세스가 요청하는 상태
- 비선점: 다른 프로세스의 자원을 강제적으로 가져올 수 없음
- 환형 대기: A->B->A이렇게 물려있음

해결방법
### 1️⃣ **예방 (`Prevention`)**

- 교착상태가 발생할 수 있는 요구조건을 만족시키지 않게 함으로써 교착상태를 방지한다.
- 위에 있는 교착상태 발생의 네가지 조건 중에서 어느 하나를 제거함으로써 수행된다.
- 자원 낭비가 가장 심한 기법이다.

### 2️⃣ **회피 (`Avoidance`)**

- 교착상태가 발생할 가능성을 배제하지 않고 교착상태가 발생하면 적절히 피해나가는 방법이다.
- 리소스 할당의 측면에서, 교착상태가 발생할 가능성이 있는 자원 할당(unsafe allocation)을 하지 않는다.
- 주로 **은행원 알고리즘(Banker's Algorithm)**이 사용된다.

> **은행원 알고리즘**
> 
> - 은행원 알고리즘은 다익스트라가 제안한 기법으로, 은행에서 모든 고객의 요구가 충족되도록 현금을 할당하는데서 유래한 기법
> - 각 프로세스에게 자원을 할당하여 교착상태가 발생하지 않으며 모든 프로세스가 완료될 수 있는 상태는 `안전상태`, 교착상태가 발생할 수 있는 상태는 `불안전 상태` 라고 한다.
> - 은행원 알고리즘을 적용하기 위해서는 자원의 양과 사용자(프로세스) 수가 일정해야 한다.
> - 은행원 알고리즘은 프로세스의 모든 요구를 유한한 시간안에 할당하는 것을 보장한다.

### 3️⃣ **탐지 및 회복 (`Detection` and `Recovery`)**

- 교착상태가 발생 할 수 있도록 놔 두고 교착상태가 발생 할 경우 찾아내어 고친다.  
    

#### **탐지**

- 시스템에 교착상태가 발생했는지 점검하여 교착상태에 있는 프로세스와 자원을 발견한다.
- 교착상태 발견 알고리즘과 자원 할당 그래프 등을 사용한다.
    
    > **자원 할당 그래프의 단점** : 자원을 요청할 때마다 탐지 알고리즘을 실행하면, 오버헤드가 발생한다.
    

#### **회복**

- 교착상태를 발견했다면 회복기법을 진행한다.
- 교착상태를 일으킨 프로세스를 종료하거나 교착상태의 프로세스에 할당된 자원을 선점하여 프로세스나 자원을 회복한다.
    
    > **1. 프로세스 종료 방법**
    > 
    > - 교착 상태의 프로세스 모두 중지
    > - 교착 상태가 제거될 때까지 한 프로세스씩 중지
    > 
    > **2. 자원 선점 방법**
    > 
    > - 자원을 빼앗긴 프로세스는 강제 종류 이후 재시작
    > - 교착 상태에 빠진 프로세스가 필요로 하는 자원을 강제로 가져옴

Deadlock 이란, 다수의 프로세스나 스레드가 서로 자원을 점유하고, 다른 프로세스나 스레드가 점유한 자원을 기다리는 상황에서 발생하는 교착 상태를 말한다. 여러 개의 스레드가 서로 대기하면서 무한정 기다리게되는 무한 루프와 같은 증상이라고 보면된다.

예를들어, 스레드 1 은 자원 A을 점유하고 있는 상태에서 자원 B가 필요한 상황이다. 그리고 스레드 2 는 자원 B를 점유하고 있는 상태에서 자원 A이 필요한 상황이다. 하지만 스레드 1은 자원 B가 필요한 상황에서 자원 A을 빌려줄 수 있는 상황이 아니고, 스레드 2또한 자원 A이 필요한 상태에서 자원 B를 빌려줄 수 없는 상황인 것이다.

이처럼 다수의 쓰레드가 같은 lock을 동시에, 다른 명령에 의해 획득하려 할 때 서로 절대 불가능한 일을 계속적으로 기다리는 상황을 이야기 한다. 

[![Deadlock](https://blog.kakaocdn.net/dn/bgRSP9/btr6ouO1S99/B3N1ylkovSB8eUTXKAOKb1/img.png)](https://blog.kakaocdn.net/dn/bgRSP9/btr6ouO1S99/B3N1ylkovSB8eUTXKAOKb1/img.png)

이러한 현상은 스레드의 특징인 공유 자원에 대한 동시 엑세스로 인한 문제로, 이를 방지하기 위한 상호배제(Mutual Exclusion), 점유와 대기(Hold and Wait), 비선점(No Preemption), 순환 대기(Circular Wait) 등의 알고리즘을 통해 극복해야 한다.


출처: [https://inpa.tistory.com/entry/👩‍💻-multi-process-multi-thread#3._데드락_교착_상태](https://inpa.tistory.com/entry/%F0%9F%91%A9%E2%80%8D%F0%9F%92%BB-multi-process-multi-thread#3._%EB%8D%B0%EB%93%9C%EB%9D%BD_%EA%B5%90%EC%B0%A9_%EC%83%81%ED%83%9C) [Inpa Dev 👨‍💻:티스토리]